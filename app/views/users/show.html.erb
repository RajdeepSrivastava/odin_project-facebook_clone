<!-- app/views/users/show.html.erb -->
<h1>User Profile</h1>
<p><strong>Email:</strong> <%= @user.email %></p>

<% unless current_user == @user %>
  <% if current_user.pending_requests.include?(@user) %>
    <%= "Pending Request Sent" %>
  <% elsif current_user.sent_friend_requests.include?(@user) %>
    <%= "Request Sent" %>
  <% elsif current_user.friends.include?(@user) %>
    <%= "Already Friends" %>
  <% else %>
    <%= link_to 'Send Friend Request', friendships_path(receiver_id: @user.id), method: :post %>
  <% end %>
<% end %>

<h2>All Users</h2>
<ul>
  <% @users.each do |user| %>
    <li>
      <p><strong>Email:</strong> <%= user.email %></p>
      <% if current_user != user %>
        <% if current_user.pending_requests.include?(user) %>
          <%= "Pending Request Sent" %>
        <% elsif current_user.sent_friend_requests.include?(user) %>
          <%= "Request Sent" %>
        <% elsif current_user.friends.include?(user) %>
          <%= "Already Friends" %>
        <% else %>
          <%= link_to 'Send Friend Request', friendships_path(receiver_id: user.id), method: :post %>
        <% end %>
      <% end %>
    </li>
  <% end %>
</ul>
